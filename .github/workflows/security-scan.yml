name: My First Security Scan

# This workflow runs whenever you push code
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  security-check:
    runs-on: ubuntu-latest
    
    steps:
      # Step 1: Download your code
      - name: Checkout code
        uses: actions/checkout@v3
      
      # Step 2: Scan for hardcoded secrets
       - name: Check for hardcoded secrets
        run: |
          echo "üîç Scanning for hardcoded secrets..."
          echo "----------------------------------------"
          
          if grep -ri "password\|api_key\|secret\|token\|aws_access\|private_key" . \
              --exclude-dir=.git \
              --exclude-dir=.github \
              --exclude="*.yml" \
              --exclude="*.yaml"; then
            
            echo "----------------------------------------"
            echo "‚ùå CRITICAL: Hardcoded secrets detected!"
            echo "üö´ This deployment is BLOCKED"
            echo "----------------------------------------"
            exit 1
            
          else
            echo "‚úÖ No secrets found - safe to proceed"
          fi
      - name: List repository files
        run: |
          echo "üìÅ Files in repository:"
          ls -la
      
      # Step 4: Simple security check example
      - name: Check Python files for unsafe functions
        run: |
          echo "üêç Checking Python files for unsafe functions..."
          if find . -name "*.py" -exec grep -H "eval\|exec\|pickle" {} \;; then
            echo "‚ö†Ô∏è Found potentially unsafe functions!"
          else
            echo "‚úÖ No Python files or unsafe functions found"
          fi
